{% extends "base.html" %}

{% block title %}Keg {{ keg.keg_number }} - SBMS{% endblock %}

{% block content %}
<div class="keg-detail">
    <div class="page-header">
        <h1>Keg #{{ keg.keg_number }}</h1>
        <div class="actions">
            <a href="{{ url_for('update_keg', keg_id=keg.id) }}" class="btn btn-primary">Update Keg</a>
            <a href="{{ url_for('kegs') }}" class="btn btn-secondary">Back to Kegs</a>
        </div>
    </div>

    <div class="keg-info">
        <div class="info-grid">
            <div class="info-card">
                <h3>Basic Information</h3>
                <dl>
                    <dt>Keg Number:</dt>
                    <dd>{{ keg.keg_number }}</dd>
                    
                    <dt>Volume:</dt>
                    <dd>{{ keg.volume_liters }}L</dd>
                    
                    <dt>Condition:</dt>
                    <dd>{{ keg.condition }}</dd>
                    
                    <dt>Location:</dt>
                    <dd>{{ keg.location or 'Unknown' }}</dd>
                </dl>
            </div>

            <div class="info-card">
                <h3>Contents & Status</h3>
                <dl>
                    <dt>Contents:</dt>
                    <dd>{{ keg.contents or 'Empty' }}</dd>
                    
                    <dt>Status:</dt>
                    <dd><span class="status-{{ keg.status|lower|replace(' ', '-')|replace('/', '-') }}">{{ keg.status }}</span></dd>
                    
                    <dt>Amount Left:</dt>
                    <dd>{{ "%.1f"|format(keg.amount_left_liters) }}L</dd>
                    
                    <dt>Date Filled:</dt>
                    <dd>{{ keg.date_filled.strftime('%d-%m-%Y') if keg.date_filled else 'Unknown' }}</dd>
                </dl>
            </div>

            {% if keg.brew_name %}
            <div class="info-card">
                <h3>Brew Information</h3>
                <dl>
                    <dt>Brew:</dt>
                    <dd>{{ keg.brew_name }}</dd>
                    
                    <dt>Recipe:</dt>
                    <dd>{{ keg.recipe_name or 'Unknown' }}</dd>
                    
                    <dt>Style:</dt>
                    <dd>{{ keg.style or 'Unknown' }}</dd>
                    
                    <dt>Date Brewed:</dt>
                    <dd>{{ keg.date_brewed.strftime('%d-%m-%Y') if keg.date_brewed else 'Unknown' }}</dd>
                </dl>
            </div>
            {% endif %}

            <div class="info-card">
                <h3>Maintenance</h3>
                <dl>
                    <dt>Last Cleaned:</dt>
                    <dd>{{ keg.last_cleaned.strftime('%d-%m-%Y') if keg.last_cleaned else 'Unknown' }}</dd>
                    
                    <dt>Last Measured:</dt>
                    <dd>{{ keg.last_measured.strftime('%d-%m-%Y') if keg.last_measured else 'Never' }}</dd>
                    
                    <dt>Notes:</dt>
                    <dd>{{ keg.notes or 'No notes' }}</dd>
                </dl>
            </div>
        </div>

        {% if keg_history %}
        <div class="keg-history">
            <h2>Keg History</h2>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>{{ _('Date') }}</th>
                        <th>{{ _('Contents') }}</th>
                        <th>{{ _('Status') }}</th>
                        <th>{{ _('Amount Left') }}</th>
                        <th>{{ _('Location') }}</th>
                        <th>{{ _('Event/Occasion') }}</th>
                        <th>{{ _('Notes') }}</th>
                        <th>{{ _('Actions') }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for entry in keg_history %}
                    <tr>
                        <td>{{ entry.recorded_date.strftime('%d-%m-%Y') if entry.recorded_date else 'Unknown' }}</td>
                        <td>{{ entry.contents or 'Empty' }}</td>
                        <td><span class="status-{{ entry.status|lower|replace(' ', '-')|replace('/', '-') }}">{{ entry.status }}</span></td>
                        <td>{{ "%.1f"|format(entry.amount_left_liters or 0) }}L</td>
                        <td>{{ entry.location or 'Unknown' }}</td>
                        <td>{{ entry.arrangement or 'Normal operation' }}</td>
                        <td>{{ entry.notes or '' }}</td>
                        <td>
                            <a href="{{ url_for('edit_keg_history', keg_id=keg.id, history_id=entry.id) }}" 
                               class="btn btn-small btn-secondary">{{ _('Edit') }}</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
    </div>
</div>

<style>
.keg-history {
    margin-top: 40px;
}

.keg-history h2 {
    color: #2c3e50;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #e9ecef;
}
</style>
{% endblock %}