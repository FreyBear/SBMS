{% extends "base.html" %}

{% block title %}Recipes - BROEN SBMS{% endblock %}

{% block content %}
<div class="recipes-page">
    <div class="page-header">
        <h1>{{ _('Recipe Management') }}</h1>
        {% if current_user.can_access('recipes', 'edit') %}
        <a href="{{ url_for('create_recipe') }}" class="btn btn-primary">
            {{ _('Create New Recipe') }}
        </a>
        {% endif %}
    </div>

    {% if recipes %}
    <table class="data-table">
        <thead>
            <tr>
                <th>{{ _('Recipe Name') }}</th>
                <th>{{ _('Style') }}</th>
                <th>{{ _('Version') }}</th>
                <th>{{ _('ABV') }}</th>
                <th>{{ _('IBU') }}</th>
                <th>{{ _('Batch Size') }}</th>
                <th>{{ _('Brews') }}</th>
                <th>{{ _('Actions') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for recipe in recipes %}
            <tr>
                <td>
                    <a href="{{ url_for('recipe_detail', recipe_id=recipe.id) }}" class="recipe-link">
                        {{ recipe.name }}
                    </a>
                </td>
                <td>{{ recipe.style or '-' }}</td>
                <td>
                    <span class="version-badge">v{{ recipe.version }}</span>
                    {% if recipe.version_count > 1 %}
                    <small>({{ recipe.version_count }} versions)</small>
                    {% endif %}
                </td>
                <td>
                    {% if recipe.target_abv %}
                        {{ "%.1f"|format(recipe.target_abv) }}%
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if recipe.ibu %}
                        {{ "%.0f"|format(recipe.ibu) }} IBU
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if recipe.batch_size_liters %}
                        {{ "%.1f"|format(recipe.batch_size_liters) }}L
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>{{ recipe.brew_count }} {{ _('brews') }}</td>
                <td>
                    <a href="{{ url_for('recipe_detail', recipe_id=recipe.id) }}" class="btn btn-info btn-sm">
                        {{ _('View') }}
                    </a>
                    {% if current_user.can_access('recipes', 'edit') %}
                    <a href="{{ url_for('edit_recipe', recipe_id=recipe.id) }}" class="btn btn-warning btn-sm">
                        {{ _('Edit') }}
                    </a>
                    {% endif %}
                    <a href="{{ url_for('recipe_shopping_cart', recipe_id=recipe.id) }}" class="btn btn-shopping btn-sm">
                        ðŸ›’ {{ _('Cart') }}
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>{{ _('No recipes found in the system.') }}</p>
        {% if current_user.can_access('recipes', 'edit') %}
        <a href="{{ url_for('create_recipe') }}" class="btn btn-primary">
            {{ _('Create Your First Recipe') }}
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}